{
    "navigationFallback": { "rewrite": "/index.html" },
    "routes": [
        { "route": "/CustomerA/*", "allowedRoles": [ "customerA" ] },
        { "route": "/CustomerB/*", "allowedRoles": [ "customerB" ] }
    ],    
    "routes": [
        { "route": "/", "allowedRoles": [ "authenticated" ] }
    ],    
    "responseOverrides": {
        "401": {
          "statusCode": 302,
          "redirect": "/.auth/login/aad"
        }
    },
    "auth": {
        "rolesSource": "/api/GetRoles",
        "identityProviders": {
            "azureActiveDirectory": {
                "userDetailsClaim": "http://schemas.xmlsoap.org/ws/2005/05/identity/claims/name",
                "registration": {
                    "openIdIssuer": "https://login.microsoftonline.com/da532c9a-7613-4e84-99fd-0c807f6d60c8",
                    "clientIdSettingName": "AZURE_CLIENT_ID",
                    "clientSecretSettingName": "AZURE_CLIENT_SECRET_APP_SETTING_NAME"
                },
                "login": {
                    "loginParameters": [
                        "resource=https://graph.microsoft.com"
                    ]
                }
            }
        }
    },
    "globalHeaders": {
        "Cache-Control": "no-cache",
        "content-security-policy": "frame-ancestors https://teams.microsoft.com https://*.teams.microsoft.com https://*.cloud.microsoft"
    }
}
